<!DOCTYPE html>
<html>
<head>
    <title>Kequtwitch</title>
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.18.1/build/cssreset-context/cssreset-context-min.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/hljs.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/markdown.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
</head>
    <body>
<div id="header">
    <a href="https://www.npmjs.com/package/kequtwitch" class="badge" title="Npmjs.com"><img src="/assets/images/npmjs.png" alt="Npmjs" /></a>
    <a href="https://github.com/Kequc/kequtwitch" class="badge" title="Github.com"><img src="/assets/images/github.png" alt="Github" /></a>
    <a href="/" class="home"><strong>Kequtwitch</strong> <span class="headline">is a twitch library</span></a>
</div>
        <div id="container">
            <div id="sidebar">
<ul class="list">
    <li>
        <h4><a href="/">Home</a></h4>
        <ul>
            <li><a href="/how-it-works.html">How it works</a></li>
            <li><a href="/api.html">API</a></li>
            <li><a href="/irc.html">IRC</a></li>
            <li><a href="/msg-object.html">Msg object</a></li>
            <li><a href="/inferences.html">Inferences</a></li>
            <li><a href="/logger.html">Logger</a></li>
        </ul>
    </li>
    <li>
        <h4><a href="/examples">Examples</a></h4>
        <ul>
            <li><a href="/examples/chat.html">Chat</a></li>
            <li><a href="/examples/emotesets.html">Emotesets</a></li>
            <li><a href="/examples/followers.html">Followers</a></li>
            <li><a href="/examples/mod-and-unmod.html">Mod and unmod</a></li>
            <li><a href="/examples/ban-and-timeout.html">Ban and timeout</a></li>
            <li><a href="/examples/host-and-unhost.html">Host and unhost</a></li>
            <li><a href="/examples/hosted.html">Hosted</a></li>
        </ul>
    </li>
</ul>
            </div>

<div id="content">
<h1>Chat</h1>
<p>The most common thing you might be interested in is what people are saying in the chatroom. The following is an overly complex example that delivers three separate events. First we ignore any messages from <code>'jtv'</code>, which is a legacy (or out of date) way Twitch delivers some status messages. In the <code>privmsg</code> command it's generally information related to whether someone is hosting your channel.</p>
<p>Actions are chat messages prefixed with the string <code>ACTION /</code>, so while not necessary to deliver a different event, it's nice to be able to with the start of the message stripped off to where the user started typing.</p>
<p>Then we check if there are bits attached to the <code>msg</code>. Probably the implementation you really want is less complicated than this.</p>
<pre><code class="language-javascript">twitch.irc.infer(<span class="hljs-string">'privmsg'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">privmsg</span> (<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-keyword">if</span> (msg.prefix.user === <span class="hljs-string">'jtv'</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">if</span> (msg.params[<span class="hljs-number">1</span>].indexOf(<span class="hljs-string">'ACTION /'</span>) === <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// "ACTION /me is great!"</span>
        <span class="hljs-keyword">const</span> message = msg.params[<span class="hljs-number">1</span>].substring(<span class="hljs-number">7</span>);

        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'action'</span>
            message
        };
    }

    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">type</span>: (msg.tags.bits || <span class="hljs-number">0</span>) &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">'cheer'</span> : <span class="hljs-string">'chat'</span>
    };
});

twitch.irc.on(<span class="hljs-string">'action'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onAction</span> (<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-keyword">const</span> displayName = msg.tags.displayName;
    <span class="hljs-keyword">const</span> channel = msg.params[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">const</span> message = msg.inferred.message;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${displayName}</span> in <span class="hljs-subst">${channel}</span> actioned "<span class="hljs-subst">${message}</span>"!`</span>);
});

twitch.irc.on(<span class="hljs-string">'cheer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onCheer</span> (<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-keyword">const</span> displayName = msg.tags.displayName;
    <span class="hljs-keyword">const</span> bits = msg.tags.bits;
    <span class="hljs-keyword">const</span> [channel, message] = msg.params;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${displayName}</span> in <span class="hljs-subst">${channel}</span> cheered <span class="hljs-subst">${bits}</span> and said "<span class="hljs-subst">${message}</span>"!`</span>);
});

twitch.irc.on(<span class="hljs-string">'chat'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onChat</span> (<span class="hljs-params">msg</span>) </span>{
    <span class="hljs-keyword">const</span> displayName = msg.tags.displayName;
    <span class="hljs-keyword">const</span> [channel, message] = msg.params;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${displayName}</span> in <span class="hljs-subst">${channel}</span> said "<span class="hljs-subst">${message}</span>"!`</span>);
});
</code></pre>

</div>

        </div>
    </body>
</html>
